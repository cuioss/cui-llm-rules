= JavaScript Linting Standards
:toc: left
:toclevels: 3
:sectnums:

== Purpose
Defines comprehensive ESLint rules, configuration standards, and integration requirements for consistent code quality across JavaScript projects.

== Related Documentation
* xref:project-structure.adoc[Project Structure]: Package.json and Maven integration
* xref:formatting-standards.adoc[Formatting Standards]: Prettier integration with ESLint
* xref:javascript-best-practices.adoc[JavaScript Best Practices]: Code patterns and conventions

== ESLint Configuration Standards

=== ESLint Flat Configuration Structure
All projects must use ESLint v9+ with flat configuration format. Create an `eslint.config.js` file:

[source,javascript]
----
import js from '@eslint/js';
import sonarjs from 'eslint-plugin-sonarjs';
import jsdoc from 'eslint-plugin-jsdoc';
import jest from 'eslint-plugin-jest';
import security from 'eslint-plugin-security';
import unicorn from 'eslint-plugin-unicorn';
import promise from 'eslint-plugin-promise';
import prettier from 'eslint-plugin-prettier';
// Add framework-specific imports when needed:
// import lit from 'eslint-plugin-lit';        // For web components
// import wc from 'eslint-plugin-wc';          // For custom elements

export default [
  js.configs.recommended,
  {
    plugins: {
      sonarjs,
      jsdoc,
      jest,
      security,
      unicorn,
      promise,
      prettier,
      // Add framework-specific plugins when needed:
      // lit,    // For web components
      // wc,     // For custom elements
    },
    languageOptions: {
      ecmaVersion: 2022,
      sourceType: 'module',
      globals: {
        console: 'readonly',
        process: 'readonly',
        document: 'readonly',
        window: 'readonly',
        navigator: 'readonly',
        HTMLElement: 'readonly',
        customElements: 'readonly',
        CSSStyleSheet: 'readonly',
        setInterval: 'readonly',
        clearInterval: 'readonly',
        setTimeout: 'readonly',
        clearTimeout: 'readonly',
        Headers: 'readonly',
        fetch: 'readonly',
      },
    },
    rules: {
      // Project-specific rules (see sections below)
    },
  },
  // Test file configuration
  {
    files: ['**/*.test.js', '**/test/**/*.js'],
    plugins: { jest },
    languageOptions: {
      globals: {
        jest: 'readonly',
        describe: 'readonly',
        it: 'readonly',
        test: 'readonly',
        expect: 'readonly',
        beforeEach: 'readonly',
        afterEach: 'readonly',
        beforeAll: 'readonly',
        afterAll: 'readonly',
      },
    },
    rules: {
      // Test-specific rule overrides (see Test File Overrides section)
    },
  },
];
----

=== Required Package Dependencies

All ESLint configurations require these core dependencies:

[source,json]
----
{
  "devDependencies": {
    "eslint": "^9.14.0",
    "@eslint/js": "^9.14.0",
    "eslint-config-prettier": "^9.0.0"
  }
}
----

=== ES Module Configuration Requirements

ESLint flat configuration requires ES module support:

[source,json]
----
{
  "type": "module"
}
----

**Configuration File Structure**: Use `eslint.config.js` with flat configuration format:

[source,javascript]
----
import js from '@eslint/js';
import jsdoc from 'eslint-plugin-jsdoc';
import jest from 'eslint-plugin-jest';

export default [
  js.configs.recommended,
  {
    plugins: { jsdoc, jest },
    rules: {
      // Rule configuration
    }
  }
];
----

=== Configuration File Requirements

**File Name**: `eslint.config.js` (required)
**Syntax**: ES module format with `export default`
**Structure**: Array of configuration objects
**Plugin Import**: Direct imports instead of string references

=== Framework-Specific Extensions

**Web Components**: Add component-specific plugins for web component projects:

[source,javascript]
----
import lit from 'eslint-plugin-lit';
import wc from 'eslint-plugin-wc';

export default [
  js.configs.recommended,
  {
    plugins: {
      // ... base plugins
      lit,
      wc,
    },
    rules: {
      'lit/no-invalid-html': 'error',
      'wc/require-listener-teardown': 'error',
    }
  }
];
----

**Node.js Projects**: Configure for Node.js-specific environments:

[source,javascript]
----
export default [
  js.configs.recommended,
  {
    languageOptions: {
      globals: {
        ...globals.node,
      },
    },
    rules: {
      'no-console': 'warn', // Allow console in Node.js
    }
  }
];
----

=== Required Dependencies and Packages
All projects must include these ESLint packages in package.json:

==== Core ESLint v9 Dependencies
[source,json]
----
{
  "devDependencies": {
    "eslint": "^9.14.0",
    "@eslint/js": "^9.14.0",
    "eslint-plugin-jest": "^28.8.3",
    "eslint-plugin-jsdoc": "^46.8.0", 
    "eslint-plugin-unicorn": "^48.0.0",
    "eslint-plugin-security": "^1.7.1",
    "eslint-plugin-promise": "^6.1.1",
    "eslint-plugin-sonarjs": "^2.0.3",
    "eslint-plugin-prettier": "^5.0.0",
    "prettier": "^3.0.3"
  }
}
----

==== Core Extensions
* `@eslint/js`: Official ESLint recommended configuration (replaces airbnb-base)
* `plugin:jest/recommended`: Jest testing best practices  
* `plugin:prettier/recommended`: Prettier integration (must be last)

==== Documentation Extensions
* `plugin:jsdoc/recommended`: JSDoc documentation standards

==== Code Quality Extensions
* `plugin:unicorn/recommended`: Additional JavaScript best practices
* `plugin:security/recommended`: Security vulnerability detection
* `plugin:promise/recommended`: Promise and async/await best practices
* `plugin:sonarjs/recommended`: Code quality and complexity analysis (required for security and maintainability)

==== Framework-Specific Extensions (Optional)
When using specific frameworks:

* `plugin:lit/recommended`: Lit-specific rules (for web components)
* `plugin:wc/recommended`: Web Components best practices (when applicable)

=== Environment Configuration
Must support these environments:

[source,javascript]
----
env: {
  browser: true,    // Browser globals
  es6: true,        // ES6 globals and syntax
  jest: true,       // Jest testing globals
  node: true,       // Node.js globals
}
----

=== Parser Options
Must use modern JavaScript features:

[source,javascript]
----
parserOptions: {
  ecmaVersion: 2022,    // ES2022 support
  sourceType: 'module', // ES modules
}
----

== Required Rule Categories

=== Import/Export Rules
Essential for module management:

[source,javascript]
----
rules: {
  // Import/export rules
  'import/no-unresolved': 'off',                    // Allow unresolved imports for mocks
  'import/extensions': 'off',                       // No file extensions required
  'import/prefer-default-export': 'off',            // Allow named exports
  'import/no-extraneous-dependencies': [
    'error', 
    { devDependencies: true }
  ],
}
----

=== JavaScript Best Practices
Core JavaScript quality rules:

[source,javascript]
----
rules: {
  // General JavaScript rules
  'class-methods-use-this': 'off',       // Allow methods without 'this'
  'no-console': 'warn',                  // Warning for console statements
  'no-debugger': 'error',                // Error for debugger statements
  'no-unused-vars': 'error',             // Error for unused variables
  'no-underscore-dangle': 'off',         // Allow underscore for private properties
  'no-param-reassign': 'off',            // Allow for test setups
  'no-promise-executor-return': 'off',   // Allow for test utilities
  'prefer-const': 'error',               // Require const when possible
  'no-var': 'error',                     // No var declarations
  'arrow-spacing': 'error',              // Consistent arrow function spacing
  'object-shorthand': 'error',           // Use object shorthand
  'prefer-template': 'error',            // Use template literals
  'template-curly-spacing': 'error',     // Consistent template spacing
}
----

=== Prettier Integration Rules
Disable style rules handled by Prettier:

[source,javascript]
----
rules: {
  // Code style rules (disabled in favor of Prettier)
  quotes: 'off',                    // Handled by Prettier
  semi: 'off',                      // Handled by Prettier
  indent: 'off',                    // Handled by Prettier
  'max-len': [
    'warn', 
    { 
      code: 120, 
      ignoreComments: true, 
      ignoreUrls: true 
    }
  ],
  'comma-dangle': 'off',            // Handled by Prettier
  'object-curly-spacing': 'off',    // Handled by Prettier
  'array-bracket-spacing': 'off',   // Handled by Prettier
  
  // Prettier integration
  'prettier/prettier': 'error',
}
----

=== Function and Arrow Function Rules
Modern function standards:

[source,javascript]
----
rules: {
  // Function rules
  'function-paren-newline': 'off',
  'arrow-parens': ['error', 'always'],
  'prefer-arrow-callback': 'error',
}
----

== Framework-Specific Rules (Optional)

=== Web Component Rules
When using Lit for web components:

[source,javascript]
----
rules: {
  // Lit-specific rules (add when using Lit)
  'lit/no-legacy-template-syntax': 'error',    // Use modern Lit syntax
  'lit/no-invalid-html': 'error',              // Valid HTML in templates
  'lit/no-value-attribute': 'error',           // Proper attribute binding
  'lit/attribute-value-entities': 'error',     // Proper entity encoding
  'lit/binding-positions': 'error',            // Correct binding syntax
  'lit/no-property-change-update': 'error',    // Avoid property changes in update
  'lit/lifecycle-super': 'error',              // Call super in lifecycle methods
  'lit/no-native-attributes': 'warn',          // Avoid native attributes
}
----

=== Web Components Rules
When working with custom elements:

[source,javascript]
----
rules: {
  // Web Components rules (add when applicable)
  'wc/no-constructor-attributes': 'error',     // No attributes in constructor
  'wc/no-invalid-element-name': 'error',       // Valid custom element names
  'wc/no-self-class': 'error',                 // No self-referencing classes
  'wc/require-listener-teardown': 'error',     // Clean up event listeners
  'wc/guard-super-call': 'off',                // Allow for framework components
}
----

== JSDoc Documentation Rules

=== Required JSDoc Rules
Documentation quality standards:

[source,javascript]
----
rules: {
  // JSDoc rules
  'jsdoc/require-description': 'warn',              // Require descriptions
  'jsdoc/require-param-description': 'warn',        // Describe parameters
  'jsdoc/require-returns-description': 'warn',      // Describe return values
  'jsdoc/check-alignment': 'error',                 // Proper alignment
  'jsdoc/check-indentation': 'error',               // Consistent indentation
  'jsdoc/check-tag-names': 'error',                 // Valid JSDoc tags
  'jsdoc/check-types': 'error',                     // Valid type annotations
  'jsdoc/require-hyphen-before-param-description': 'error',
}
----

== Security Rules

=== Required Security Rules
Essential for preventing security vulnerabilities:

[source,javascript]
----
rules: {
  // Security rules
  'security/detect-object-injection': 'warn',          // Detect object injection
  'security/detect-eval-with-expression': 'error',     // Prevent eval usage
  'security/detect-unsafe-regex': 'error',             // Detect ReDoS vulnerabilities
  'security/detect-buffer-noassert': 'error',          // Safe buffer usage
  'security/detect-child-process': 'error',            // Prevent child process injection
}
----

== Promise and Async/Await Rules

=== Required Promise Rules
Modern asynchronous JavaScript patterns:

[source,javascript]
----
rules: {
  // Promise rules
  'promise/always-return': 'error',                    // Always return in promise chains
  'promise/catch-or-return': 'error',                  // Handle promise rejections
  'promise/no-return-wrap': 'error',                   // Avoid unnecessary wrapping
  'promise/param-names': 'error',                      // Consistent parameter names
  'promise/no-nesting': 'warn',                        // Avoid nested promises
  'promise/prefer-await-to-then': 'warn',              // Prefer async/await
  'promise/prefer-await-to-callbacks': 'warn',         // Modernize callback patterns
}
----

== SonarJS Code Quality Rules

=== SonarJS Required Configuration
SonarJS is required for all projects to ensure comprehensive code quality and complexity analysis. Use the default SonarJS recommended configuration:

[source,javascript]
----
export default [
  // ... other configurations
  sonarjs.configs.recommended,   // Use SonarJS defaults
  {
    plugins: { sonarjs },
    rules: {
      // SonarJS rules - using recommended defaults
      // All SonarJS rules are automatically configured with appropriate severity levels
      // Most rules default to 'error' severity
      // Only override specific rules if project requirements differ from defaults
    }
  }
];
----

=== SonarJS Default Rules
The recommended configuration automatically enables these rules with default settings:

==== Error Level Rules (Default)
* `sonarjs/cognitive-complexity`: Limits cognitive complexity (default: 15)
* `sonarjs/no-identical-functions`: Detects duplicate functions
* `sonarjs/no-collapsible-if`: Simplifies conditional logic
* `sonarjs/prefer-immediate-return`: Simplifies return statements
* `sonarjs/prefer-object-literal`: Enforces object literals
* `sonarjs/prefer-single-boolean-return`: Simplifies boolean returns
* `sonarjs/no-small-switch`: Warns about small switch statements
* `sonarjs/no-redundant-boolean`: Removes redundant booleans
* `sonarjs/no-unused-collection`: Detects unused collections
* `sonarjs/no-useless-catch`: Removes useless catch blocks

==== Disabled Rules (Default)
* `sonarjs/no-inverted-boolean-check`: Disabled by default
* `sonarjs/elseif-without-else`: Disabled by default

=== SonarJS Rule Customization
Only override SonarJS defaults when project-specific requirements demand it:

[source,javascript]
----
rules: {
  // Override only when necessary
  'sonarjs/cognitive-complexity': ['warn', 20],  // Increase threshold if needed
  'sonarjs/no-duplicate-string': ['warn', { threshold: 3 }], // Adjust threshold
}
----

== Modern JavaScript Features

=== Required Modern JavaScript Rules
Enforce modern JavaScript patterns:

[source,javascript]
----
rules: {
  // Modern JavaScript features
  'prefer-destructuring': ['error', { array: false, object: true }], // Use destructuring
  'prefer-rest-params': 'error',                       // Use rest parameters
  'prefer-spread': 'error',                            // Use spread operator
  'symbol-description': 'error',                       // Require symbol descriptions
  'no-useless-computed-key': 'error',                  // Remove useless computed keys
  'no-useless-rename': 'error',                        // Remove useless renaming
  'no-useless-return': 'error',                        // Remove useless returns
  'no-void': 'error',                                  // Disallow void operator
  'no-with': 'error',                                  // Disallow with statements
  
  // ES6+ features
  'prefer-numeric-literals': 'error',                  // Use numeric literals
  'prefer-object-spread': 'error',                     // Use object spread
  'prefer-exponentiation-operator': 'error',           // Use ** operator
  'prefer-regex-literals': 'error',                    // Use regex literals
  'prefer-promise-reject-errors': 'error',             // Proper promise rejection
}
----

== Error Handling and Performance

=== Error Handling Rules
Robust error handling patterns:

[source,javascript]
----
rules: {
  // Error handling
  'no-throw-literal': 'error',                         // Throw Error objects
  'no-return-await': 'error',                          // Avoid redundant await
  'require-await': 'warn',                             // Require await in async functions
  'no-async-promise-executor': 'error',                // No async promise executors
  'no-await-in-loop': 'warn',                          // Avoid await in loops
  'no-promise-executor-return': 'error',               // No returns in promise executors
}
----

=== Performance Rules
Code performance optimizations:

[source,javascript]
----
rules: {
  // Performance
  'no-loop-func': 'error',                             // No functions in loops
  'no-extend-native': 'error',                         // No native prototype extension
  'no-iterator': 'error',                              // No __iterator__ usage
  'no-proto': 'error',                                 // No __proto__ usage
  'no-script-url': 'error',                            // No javascript: URLs
}
----

=== Maintainability Rules
Code maintainability standards:

[source,javascript]
----
rules: {
  // Maintainability
  'complexity': ['warn', { max: 10 }],                 // Cyclomatic complexity
  'max-statements': ['warn', { max: 20 }],             // Maximum statements per function
  'max-params': ['warn', { max: 5 }],                  // Maximum function parameters
  'max-nested-callbacks': ['error', { max: 4 }],       // Maximum callback nesting
  'no-magic-numbers': ['warn', { 
    ignore: [-1, 0, 1, 2, 100, 200, 404, 500, 1000, 30000],
    ignoreArrayIndexes: true,
    ignoreDefaultValues: true 
  }],
}
----

== Unicorn Best Practices

=== Recommended Unicorn Rules
Additional code quality improvements:

[source,javascript]
----
rules: {
  // Unicorn rules (additional best practices)
  'unicorn/filename-case': 'off',                   // Allow kebab-case for components
  'unicorn/prevent-abbreviations': 'off',           // Allow common abbreviations
  'unicorn/no-null': 'off',                         // Allow null values
  'unicorn/prefer-dom-node-text-content': 'off',    // Allow textContent usage
  'unicorn/prefer-query-selector': 'error',         // Use querySelector
  'unicorn/prefer-modern-dom-apis': 'error',        // Use modern DOM APIs
  'unicorn/no-array-for-each': 'off',               // Allow forEach for readability
  'unicorn/consistent-function-scoping': 'warn',    // Consistent function scoping
}
----

== Environment-Specific Overrides

=== Test File Overrides
Relaxed rules for test files:

[source,javascript]
----
overrides: [
  {
    files: ['src/test/js/**/*.js'],
    rules: {
      'jsdoc/require-jsdoc': 'off',
      'jsdoc/require-description': 'off',
      'jsdoc/require-param-description': 'off',
      'jsdoc/require-returns-description': 'off',
      'jsdoc/require-param-type': 'off',
      'jsdoc/require-returns': 'off',
      'unicorn/consistent-function-scoping': 'off',
      'lit/no-legacy-template-syntax': 'off',
      'max-len': 'off',
      'no-unused-expressions': 'off',
      'no-unused-vars': 'warn',
      'no-undef': 'off',    // Jest globals handled by environment
      // Relaxed rules for test files
      'sonarjs/cognitive-complexity': 'off',
      'sonarjs/no-duplicate-string': 'off',
      'complexity': 'off',
      'max-statements': 'off',
      'max-params': 'off',
      'require-await': 'off',
      'no-magic-numbers': 'off',
      'security/detect-object-injection': 'off',
      'promise/prefer-await-to-then': 'off',
      'promise/always-return': 'off',
      'no-promise-executor-return': 'off',
      'arrow-parens': 'off', // Let Prettier handle this for test files
      // Jest-specific rules
      'jest/expect-expect': [
        'error',
        {
          assertFunctionNames: ['expect', 'assert*', 'should*'],
        },
      ],
      'jest/no-disabled-tests': 'warn',
      'jest/no-focused-tests': 'error',
      'jest/prefer-to-have-length': 'error',
      'jest/valid-expect': 'error',
    },
  },
]
----

=== Production Component Overrides
Stricter rules for production components:

[source,javascript]
----
overrides: [
  {
    files: ['src/main/resources/components/**/*.js'],
    rules: {
      'jsdoc/require-jsdoc': 'error',           // Require JSDoc for public components
      'jsdoc/require-description': 'error',     // Require descriptions
      'max-len': ['warn', { code: 120 }],       // Line length limit
      'complexity': ['warn', { max: 15 }],      // Cyclomatic complexity
      'max-depth': ['error', { max: 4 }],       // Maximum nesting depth
      'max-lines-per-function': ['warn', { max: 100 }], // Function length limit
    },
  },
]
----

=== Mock File Overrides
Relaxed rules for mock files:

[source,javascript]
----
overrides: [
  {
    files: ['src/test/js/mocks/**/*.js'],
    rules: {
      'jsdoc/require-jsdoc': 'off',
      'unicorn/consistent-function-scoping': 'off',
      'unicorn/no-array-reduce': 'off',
      'unicorn/prefer-logical-operator-over-ternary': 'off',
      'no-restricted-syntax': 'off',
      'no-plusplus': 'off',
      'class-methods-use-this': 'off',
      'no-unused-vars': 'off',
      'max-lines-per-function': 'off',
      // Additional relaxed rules for mock files
      'sonarjs/no-identical-functions': 'off',
      'sonarjs/cognitive-complexity': 'off',
      'security/detect-object-injection': 'off',
      'promise/prefer-await-to-then': 'off',
      'promise/always-return': 'off',
      'no-promise-executor-return': 'off',
      'complexity': 'off',
      'max-statements': 'off',
      'arrow-parens': 'off', // Let Prettier handle this for mock files
    },
  },
]
----

== Stylelint Integration (Optional)

=== CSS-in-JS Linting
When using CSS-in-JS patterns (e.g., Lit components):

[source,javascript]
----
// Package.json scripts (add when using CSS-in-JS)
"lint:style": "stylelint src/**/*.js",
"lint:style:fix": "stylelint --fix src/**/*.js",
----

=== Stylelint Configuration
When using CSS-in-JS patterns:

* `stylelint-config-standard`: Standard CSS rules
* `stylelint-order`: CSS property ordering
* `postcss-lit`: PostCSS support (for Lit templates when applicable)

== Integration Requirements

=== NPM Scripts Integration
Required package.json scripts:

[source,json]
----
{
  "scripts": {
    // Base scripts (always required)
    "lint:js": "eslint src/**/*.js",
    "lint:js:fix": "eslint --fix src/**/*.js",
    
    // When using CSS-in-JS (optional)
    "lint:style": "stylelint src/**/*.js",
    "lint:style:fix": "stylelint --fix src/**/*.js",
    
    // Combined scripts
    "lint": "npm run lint:js",                                    // Base version
    "lint": "npm run lint:js && npm run lint:style",             // With CSS-in-JS
    "lint:fix": "npm run lint:js:fix",                           // Base version
    "lint:fix": "npm run lint:js:fix && npm run lint:style:fix"  // With CSS-in-JS
  }
}
----

== StyleLint Configuration Standards

=== CSS-in-JS Linting with StyleLint
For projects using CSS-in-JS (particularly Lit components), configure StyleLint for CSS validation:

==== Required StyleLint Dependencies
[source,json]
----
{
  "devDependencies": {
    "stylelint": "^16.10.0",
    "stylelint-config-standard": "^36.0.1",
    "stylelint-order": "^6.0.3",
    "stylelint-declaration-strict-value": "^1.10.6",
    "postcss-lit": "^1.0.0"
  }
}
----

==== StyleLint ES Module Configuration
Create `.stylelintrc.js` with ES module syntax when using `"type": "module"`:

[source,javascript]
----
/**
 * StyleLint configuration for CSS-in-JS in web components
 * 
 * This configuration ensures consistent CSS styling within
 * component template literals and CSS-in-JS constructs.
 */

export default {
  extends: [
    'stylelint-config-standard'
  ],
  
  plugins: [
    'stylelint-order',
    'stylelint-declaration-strict-value'
  ],
  
  // Custom syntax for CSS-in-JS
  customSyntax: 'postcss-lit',
  
  rules: {
    // Modern CSS formatting
    'color-hex-length': 'short',
    
    // Logical property ordering
    'order/properties-order': [
      'content', 'display', 'position', 'top', 'right', 'bottom', 'left',
      'z-index', 'flex', 'flex-grow', 'flex-shrink', 'flex-basis',
      'width', 'height', 'margin', 'padding', 'border', 'background',
      'color', 'font', 'text-align', 'opacity', 'transform', 'transition'
    ],
    
    // CSS Custom Properties enforcement
    'scale-unlimited/declaration-strict-value': [
      ['/color$/', 'fill', 'stroke', 'background-color'],
      {
        'ignoreValues': [
          'currentColor', 'transparent', 'inherit', 'initial', 'unset'
        ]
      }
    ],
    
    // CSS Custom Properties patterns  
    'custom-property-pattern': '^[a-z][a-z0-9]*(-[a-z0-9]+)*$',
    'custom-property-empty-line-before': 'never',
    
    // Web component-specific CSS patterns
    'selector-pseudo-class-no-unknown': [
      true,
      {
        ignorePseudoClasses: ['host', 'host-context', 'focus-visible'],
      },
    ],
    
    // Performance and maintainability
    'max-nesting-depth': 3,
    'selector-max-id': 0,
    'selector-max-universal': 1,
    
    // Disable rules that conflict with CSS-in-JS
    'no-empty-source': null,
    'value-keyword-case': null,
  },
  
  overrides: [
    {
      files: ['src/main/resources/components/**/*.js'],
      rules: {
        // Stricter rules for production components
        'max-nesting-depth': 3,
        'selector-max-compound-selectors': 4,
      },
    },
    {
      files: ['src/test/js/**/*.js'],
      rules: {
        // Relaxed rules for test files
        'selector-class-pattern': null,
        'custom-property-pattern': null,
      },
    },
  ],
};
----

==== Common StyleLint Configuration Issues

**Issue: Duplicate rule definitions**
- **Problem**: Same rule appears multiple times in configuration
- **Symptoms**: `There are duplicate names used: property-no-unknown`
- **Solution**: Remove duplicate rule definitions, keep only one instance

**Issue: Framework-specific theme variables**
- **Problem**: Configuration includes unnecessary framework-specific patterns
- **Solution**: Use generic patterns unless specific framework integration required:
  ```javascript
  // Generic (preferred)
  'custom-property-pattern': '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
  
  // Framework-specific (only when needed)
  'custom-property-pattern': '^(lumo|vaadin)-[a-z0-9]+(-[a-z0-9]+)*$'
  ```

**Issue: ES module import errors**
- **Problem**: `Cannot use import statement outside a module`
- **Solution**: Use `export default` syntax when `"type": "module"` is set

==== StyleLint npm Scripts
Add these scripts to package.json:

[source,json]
----
{
  "scripts": {
    "lint:css": "stylelint src/**/*.js",
    "lint:css:fix": "stylelint --fix src/**/*.js",
    "validate:css": "npm run lint:css && npm run format:js:check"
  }
}
----

==== Maven Integration with StyleLint
Include StyleLint in Maven build process:

[source,xml]
----
<execution>
  <id>npm-css-validate</id>
  <goals>
    <goal>npm</goal>
  </goals>
  <phase>compile</phase>
  <configuration>
    <arguments>run validate:css</arguments>
  </configuration>
</execution>
----

=== Maven Integration
Required Maven execution:

[source,xml]
----
<execution>
  <id>npm-lint-fix</id>
  <goals>
    <goal>npm</goal>
  </goals>
  <phase>verify</phase>
  <configuration>
    <arguments>run lint:fix</arguments>
  </configuration>
</execution>
----

=== CI/CD Integration
Linting must be part of the build pipeline:

1. **Local Development**: Pre-commit hooks recommended
2. **Build Pipeline**: Automatic fixing in verify phase
3. **Quality Gates**: Must pass linting for successful builds

== Error Handling Standards

=== Error Severity Levels
* **Error**: Build-breaking issues that must be fixed
* **Warning**: Issues that should be addressed but don't break builds
* **Off**: Rules that are disabled for specific contexts

=== Common Fixes
* Use `eslint --fix` for automatic fixes
* Manual review required for complex rule violations
* Document any rule exceptions with comments

== Performance Considerations

=== Caching
* Enable ESLint caching for faster subsequent runs
* Use `.eslintcache` in gitignore
* Consider parallel execution for large codebases

=== Rule Selection
* Focus on rules that provide real value
* Avoid overly restrictive rules that impede development
* Balance code quality with developer productivity

== Cypress E2E Testing Configuration

=== Cypress-Specific ESLint Configuration
For Cypress end-to-end testing projects, implement specialized ESLint configuration that achieves zero-warning compliance while supporting Cypress testing patterns.

==== Complete Cypress ESLint Configuration
Based on successful 98 warnings â†’ 0 warnings implementation:

[source,javascript]
----
// .eslintrc.js for Cypress projects
module.exports = {
  env: {
    browser: true,
    es2021: true,
    node: true,
    "cypress/globals": true
  },
  extends: [
    "eslint:recommended",
    "plugin:cypress/recommended",
    "plugin:jsdoc/recommended",
    "plugin:prettier/recommended"
  ],
  parserOptions: {
    ecmaVersion: 2022,
    sourceType: "module"
  },
  plugins: [
    "cypress", 
    "prettier", 
    "jsdoc", 
    "sonarjs", 
    "security",
    "unicorn"
  ],
  rules: {
    // CUI Standards - Fundamental Rules
    "no-console": "warn",
    "no-unused-vars": ["warn", { 
      "argsIgnorePattern": "^_", 
      "varsIgnorePattern": "^_" 
    }],
    "prefer-const": "error",
    "no-var": "error",
    
    // CUI Standards - Code Quality Rules
    "prettier/prettier": "error",
    
    // CUI Standards - Cypress Rules (Adapted for Best Practices)
    "cypress/no-unnecessary-waiting": "warn",        // Encourage proper element waiting
    "cypress/unsafe-to-chain-command": "off",        // Allow chaining for common Cypress patterns
    "cypress/no-assigning-return-values": "error",   // Prevent async handling issues
    
    // CUI Standards - JSDoc Documentation Requirements (Cypress-adapted)
    "jsdoc/require-description": "error",
    "jsdoc/require-param-description": "error", 
    "jsdoc/require-returns-description": "error",
    "jsdoc/require-example": "warn",
    "jsdoc/no-undefined-types": "off",               // Allow jQuery types
    
    // CUI Standards - Code Complexity Rules (Cypress-adapted)
    "complexity": ["warn", 20],                      // Increased for Cypress test complexity
    "max-depth": ["warn", 5],                        // Increased for nested describes/its
    "max-lines-per-function": ["warn", 200],         // Cypress test functions can be large
    "max-params": ["error", 5],
    
    // CUI Standards - Security Rules
    "security/detect-object-injection": "warn",
    "security/detect-non-literal-regexp": "warn",
    
    // CUI Standards - Code Quality from SonarJS (Cypress-adapted)
    "sonarjs/cognitive-complexity": ["warn", 25],    // Increased for Cypress test complexity
    "sonarjs/no-duplicate-string": "off",            // Handle via constants instead
    "sonarjs/no-identical-functions": "warn",        // Allow similar test patterns
    
    // CUI Standards - Additional Quality Rules
    "unicorn/filename-case": ["error", { "case": "kebabCase" }],
    "unicorn/no-null": "off",                        // Allow null for Cypress compatibility
  },
  
  // Cypress-specific file overrides
  overrides: [
    {
      files: ["cypress/e2e/**/*.cy.js", "cypress/integration/**/*.cy.js"],
      rules: {
        "max-lines-per-function": "off",             // Tests can be very large
        "complexity": "off",                         // Tests naturally complex
        "sonarjs/cognitive-complexity": "off",       // Tests naturally complex
        "sonarjs/no-duplicate-string": "off",        // Allow duplicate strings in test files
        "jsdoc/require-jsdoc": "off",               // Don't require JSDoc for test functions
        "jsdoc/require-description": "off",
        "jsdoc/require-param-description": "off",
        "jsdoc/require-returns-description": "off",
        "jsdoc/require-example": "off",
        "jsdoc/no-undefined-types": "off",          // Allow undefined types in tests
        "cypress/unsafe-to-chain-command": "off",   // Allow chaining in tests  
        "cypress/no-unnecessary-waiting": "off",    // Allow waits in tests
        "no-unused-vars": "warn"                    // Keep as warning for cleanup
      }
    },
    {
      files: ["cypress/support/**/*.js"],
      rules: {
        "max-lines-per-function": ["warn", 150],    // Support functions can be larger
        "complexity": ["warn", 20],
        "sonarjs/cognitive-complexity": ["warn", 15],
        "jsdoc/require-jsdoc": "off",              // Relaxed JSDoc for commands
        "security/detect-object-injection": "off", // Dynamic property access needed
        "cypress/unsafe-to-chain-command": "off",  // Allow chaining in support files
        "cypress/no-unnecessary-waiting": "off",   // Allow necessary waits
        "sonarjs/no-duplicate-string": "off"       // Allow duplicate strings
      }
    },
    {
      files: ["cypress/selftests/**/*.cy.js"],
      rules: {
        "max-lines-per-function": "off",           // Complete flexibility
        "complexity": "off",                       // No complexity limits
        "sonarjs/cognitive-complexity": "off",     // No constraints
        "sonarjs/no-duplicate-string": "off",      // Allow duplicate strings
        "jsdoc/require-jsdoc": "off",             // No documentation required
        "cypress/unsafe-to-chain-command": "off", // Full chaining freedom
        "cypress/no-unnecessary-waiting": "off",  // Allow waits
        "no-unused-vars": "warn"
      }
    }
  ]
};
----

==== Required Cypress Dependencies
[source,json]
----
{
  "devDependencies": {
    "cypress": "^13.0.0",
    "eslint": "^8.57.1",
    "eslint-config-prettier": "^9.1.0",
    "eslint-plugin-cypress": "^3.5.0",
    "eslint-plugin-jsdoc": "^46.8.0",
    "eslint-plugin-prettier": "^5.2.1",
    "eslint-plugin-security": "^2.1.1",
    "eslint-plugin-sonarjs": "^0.25.1",
    "eslint-plugin-unicorn": "^52.0.0",
    "prettier": "^3.4.2"
  }
}
----

==== Cypress NPM Scripts
[source,json]
----
{
  "scripts": {
    "cypress:run": "cypress run",
    "cypress:open": "cypress open",
    "lint": "eslint 'cypress/**/*.js'",
    "lint:fix": "eslint 'cypress/**/*.js' --fix",
    "lint:check": "eslint 'cypress/**/*.js' --max-warnings 0",
    "format": "prettier --write 'cypress/**/*.js'",
    "format:check": "prettier --check 'cypress/**/*.js'"
  }
}
----

==== Constants-Based Duplicate String Management
Cypress projects must implement comprehensive constants to achieve zero duplicate string warnings:

[source,javascript]
----
// cypress/support/constants.js
export const SELECTORS = {
  // Common UI selectors
  PROCESSOR: 'g.processor, [class*="processor"], .component',
  CANVAS_SELECTOR: '.canvas',
  CONTEXT_MENU_SELECTOR: '.context-menu, .mat-menu-panel, [role="menu"]',
  DIALOG: '[role="dialog"], .mat-dialog-container, .dialog',
  
  // Form elements
  USERNAME_INPUT: '#username',
  PASSWORD_INPUT: '#password',
  LOGIN_BUTTON: '#login-button',
  
  // Data-testid selectors
  PROCESSOR_DETAILS_METRICS: '[data-testid="processor-details-metrics"]',
  CONFIG_DIALOG_TABS: '[data-testid="config-dialog-tabs"]'
};

export const TEXT_CONSTANTS = {
  // Common assertions
  BE_VISIBLE: 'be.visible',
  BE_ENABLED: 'be.enabled',
  EXIST: 'exist',
  CONTAIN: 'contain',
  HAVE_TEXT: 'have.text',
  
  // Common text values
  APPLY: 'Apply',
  CANCEL: 'Cancel',
  SAVE: 'Save',
  LOGIN: 'Login',
  
  // Application-specific constants
  MULTI_ISSUER_JWT_TOKEN_AUTHENTICATOR: 'MultiIssuerJWTTokenAuthenticator',
  ADMIN: 'admin',
  ADMIN_PASSWORD: 'adminadminadmin'
};

export const TEST_DATA = {
  // Test URLs and endpoints
  TEST_ISSUER_URL: 'https://test.example.com',
  TEST_JWKS_JSON_URL: 'https://test.example.com/jwks.json',
  
  // Test credentials
  VALID_USERNAME: 'testuser',
  TEST_PASSWORD: 'testpass',
  
  // Configuration values
  SERVER_TYPE: 'server',
  IN_MEMORY_TYPE: 'In-Memory'
};

export const TIMEOUTS = {
  SHORT: 1000,
  MEDIUM: 2000,
  LONG: 5000,
  VERY_LONG: 10000
};
----

==== Console Error Management for Cypress
Implement console error tracking and validation:

[source,javascript]
----
// cypress/support/console-warnings-allowlist.js
module.exports = [
  // Third-party library warnings that cannot be fixed
  'Warning: validateDOMNesting(...): <div> cannot appear as a descendant of <p>.',
  'DevTools failed to load source map',
  'Content Security Policy violation for inline script',
  
  // Framework-specific warnings
  'Synchronous XMLHttpRequest on the main thread is deprecated',
  '[Firefox] Unable to preventdefault inside passive event listener'
];
----

[source,javascript]
----
// cypress/support/console-error-tracking.js
const allowedWarnings = require('./console-warnings-allowlist');

Cypress.on('window:before:load', (win) => {
  win.consoleErrors = [];
  win.consoleWarnings = [];

  const originalConsole = {
    error: win.console.error,
    warn: win.console.warn,
  };

  win.console.error = (...args) => {
    originalConsole.error(...args);
    const message = args.map(arg => 
      typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
    ).join(' ');
    win.consoleErrors.push(message);
  };

  win.console.warn = (...args) => {
    originalConsole.warn(...args);
    const message = args.map(arg => 
      typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
    ).join(' ');
    
    if (!allowedWarnings.some(allowedMsg => message.includes(allowedMsg))) {
      win.consoleWarnings.push(message);
    }
  };
});

Cypress.Commands.add('verifyNoConsoleErrors', () => {
  cy.window().then((win) => {
    const errors = win.consoleErrors || [];
    if (errors.length > 0) {
      throw new Error(`Console errors detected: ${errors.join(', ')}`);
    }
  });
});

Cypress.Commands.add('verifyNoUnexpectedWarnings', () => {
  cy.window().then((win) => {
    const warnings = win.consoleWarnings || [];
    if (warnings.length > 0) {
      throw new Error(`Unexpected console warnings: ${warnings.join(', ')}`);
    }
  });
});
----

=== Cypress Rule Rationale

==== Why `cypress/unsafe-to-chain-command` is Disabled
Cypress chaining is a fundamental pattern that improves test readability:
[source,javascript]
----
// Natural Cypress pattern (allowed)
cy.get(SELECTORS.PROCESSOR)
  .should(TEXT_CONSTANTS.BE_VISIBLE)
  .click()
  .should('have.class', 'active');
----

==== Why `sonarjs/no-duplicate-string` is Disabled
Instead of suppressing warnings, use constants-based approach:
[source,javascript]
----
// Problem: Duplicate strings trigger warnings
cy.get('.processor').should('be.visible');
cy.get('.processor').click();

// Solution: Constants eliminate duplication
cy.get(SELECTORS.PROCESSOR).should(TEXT_CONSTANTS.BE_VISIBLE);
cy.get(SELECTORS.PROCESSOR).click();
----

==== Complexity Thresholds Adjusted for Testing
E2E tests naturally have higher complexity due to comprehensive user workflow testing:
- **Standard complexity limit**: 10
- **Cypress test complexity limit**: 20-25
- **Cypress support function limit**: 15-20