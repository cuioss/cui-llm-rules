= Research Topics: Requires Verification
:toc: left
:toclevels: 3
:sectnums:

== Overview

**Document Purpose**: Research tracking (not specification)

This document identifies assumptions in the plugin architecture that **require empirical verification** before implementation. These are not design decisions but **unknowns about Claude Code/Claude.ai capabilities** that could affect architectural feasibility.

**Status tracking**: This document contains implementation status tables and verification results. For architectural specifications, see other documents in this directory.

== Status Legend

* ‚ö†Ô∏è **CRITICAL** - Could break core architecture if assumption is wrong
* üîç **IMPORTANT** - Affects implementation approach
* üí° **OPTIMIZATION** - Affects performance or user experience

'''

== CRITICAL Research Topics (Currently Deferred)

=== 1. Skills Access from Claude.ai Web ‚ö†Ô∏è CRITICAL (‚è∏Ô∏è Deferred)

==== Current Assumption

**Documented in**: `architecture-overview.adoc:122-170` (Skills Access Mechanism)

**Assumption**: Claude.ai web can automatically fetch skills from public GitHub repositories via URL.

**What the spec claims**:
[source]
----
Agent prompt: "Read cui-java-standards skill from https://github.com/cuioss/cui-llm-rules"
‚Üí Claude fetches: https://github.com/cuioss/cui-llm-rules/skills/cui-java-standards/SKILL.md
‚Üí Skill references: ./standards/java/java-code-standards.adoc
‚Üí Claude fetches: https://github.com/cuioss/cui-llm-rules/standards/java/java-code-standards.adoc
----

==== Why This Matters (and Why It's Deferred)

**Original Concern**: If dynamic access doesn't work, the entire cross-platform strategy fails.

**Current Resolution**: ‚úÖ Cross-platform strategy already works via Project Synchronization
* Skills ARE synchronized to `.claude/skills/` (not "never synchronized" as originally planned)
* This approach works on all platforms TODAY (Claude Code, Claude.ai web, CI/CD)
* Dynamic access would be an optimization, not a requirement

**Why Still Track This**:
* Could reduce synchronization overhead in future
* May enable "always current" skills without manual sync
* Affects long-term maintenance burden

**Why Deferred**:
* Working solution exists (Project Synchronization)
* Focus on Claude Code implementation first
* Can research later if synchronization proves problematic

==== What Needs Testing

**Test Environment**: Claude.ai web interface (NOT Claude Code)

**Test Scenario 1: Direct URL in Agent Prompt**
[source,markdown]
----
# In .claude/agents/test-agent.md
System prompt:
"Read the skill file from this URL:
https://raw.githubusercontent.com/cuioss/cui-llm-rules/main/skills/cui-java-standards/SKILL.md

Then follow the instructions in that skill."
----

**Expected Behavior**:
* ‚úÖ Claude can access the URL
* ‚úÖ Claude reads the SKILL.md content
* ‚úÖ Claude can then follow references to standards files

**Test Scenario 2: Skill Reference by Name**
[source,markdown]
----
# In .claude/agents/test-agent.md
System prompt:
"Read the cui-java-standards skill from the cuioss/cui-llm-rules repository."
----

**Expected Behavior**:
* ‚úÖ Claude resolves skill name to repository URL
* ‚úÖ Claude fetches skill content

**Test Scenario 3: Relative Path Resolution**
[source,markdown]
----
# After Claude reads SKILL.md which contains:
"Read standards from: ./standards/java/java-code-standards.adoc"
----

**Expected Behavior**:
* ‚úÖ Claude resolves relative path against repository root
* ‚úÖ Claude fetches: https://github.com/cuioss/cui-llm-rules/standards/java/java-code-standards.adoc

==== Acceptance Criteria

* [ ] Test Scenario 1 succeeds (direct URL fetch)
* [ ] Test Scenario 3 succeeds (relative path resolution after fetch)
* [ ] Test Scenario 2 is optional (nice-to-have skill name resolution)

==== Resolution Status

**‚úÖ RESOLVED**: Option B has been adopted as the standard approach

**Chosen Approach: Skills in Project .claude/** (Option B)
* Synchronize skills to `.claude/skills/` via `/synchronize --all --include-skills`
* ‚úÖ Available to all platforms (Claude Code, Claude.ai web, CI/CD)
* ‚úÖ Git-controlled for version management
* ‚ö†Ô∏è Requires manual synchronization (use `/synchronize --check` to detect drift)

**Why this works**:
* Proven mechanism - same as agents/commands distribution
* No dependency on unverified dynamic access
* Simple mental model: "everything in `.claude/` is synchronized"

**Other considered approaches**:

**Option A: Embed Essential Content in Agents** (rejected)
* Would defeat purpose of skills layer
* High drift risk, large agent files

**Option C: Hybrid Approach** (partially adopted)
* Essential Rules embedded in agents for core requirements ‚úÖ
* Skills provide complete, detailed standards ‚úÖ
* Agents reference skills for full context ‚úÖ

==== Verification Steps

. Create test repository with sample skill
. Create test agent that references skill by URL
. Deploy to project `.claude/agents/`
. Test in Claude.ai web interface
. Document actual behavior
. Update architecture if needed

'''

== IMPORTANT Research Topics

=== 2. Plugin Update Mechanism ‚úÖ VERIFIED

==== Current Assumption

**Documented in**: `plugin-structure.adoc:663-689` (Known Limitations)

**Assumption**: No individual plugin update command exists; updates via `/plugin marketplace update marketplace-name`

==== Verification Result

**Status**: ‚úÖ **ASSUMPTION CORRECT**

**Tested**: 2025-10-22 (via documentation analysis)

**Confirmed Commands**:
* `/plugin marketplace update marketplace-name` - ‚úÖ Exists
* `/plugin update plugin-name` - ‚ùå Does NOT exist

**Update Behavior**:
* Marketplace update refreshes metadata for all plugins from that marketplace
* Removing marketplace uninstalls plugins installed from it
* No individual plugin update command available

==== Documentation Updated

* ‚úÖ `plugin-structure.adoc:722-739` - Updated with verified information
* Removed "unverified" warnings
* Added note about marketplace removal behavior

'''

=== 3. Semantic Version Pinning üîç

==== Current Assumption

**Documented in**: `plugin-structure.adoc:569-574`

**Assumption**: Cannot pin to specific plugin version (e.g., `cui-standards@1.2.0`)

==== What Needs Testing

**Test Scenario**:
[source,bash]
----
# Does this work?
/plugin install cui-standards@1.0.0

# Or does it always install latest?
/plugin install cui-standards@cui-llm-rules
----

==== Why This Matters

* Affects version management strategy
* Impacts team consistency (can teams enforce same version?)
* Affects rollback capability

==== Verification Steps

. Create plugin with v1.0.0
. Tag and release v1.1.0
. Try installing v1.0.0 specifically
. Document whether version pinning is supported

'''

=== 4. Skills Loading at Runtime ‚úÖ VERIFIED (Strategy 1)

==== Status

**Documented in**: `architecture-overview.adoc:196-210` (Progressive Disclosure Model)

**Verification Status**: ‚úÖ **VERIFIED** for Strategy 1 (Project Synchronization)

**Strategy 1 (Synchronized Skills)**:
* Skills synchronized to `.claude/skills/` are loaded as regular files
* Claude reads SKILL.md when skill is invoked or referenced
* Skills can use Read tool to fetch standards dynamically
* Relative paths resolve against project root (`.claude/skills/...`)

**Strategy 2 (Dynamic Repository Access)**: ‚ö†Ô∏è NOT VERIFIED - See Topic #1

==== Verified Behavior (Strategy 1)

When skills are synchronized to `.claude/skills/`:

1. **Discovery**: Claude discovers skills in `.claude/skills/` at startup
2. **Loading**: SKILL.md content loaded when skill is activated (on-demand)
3. **Tool Access**: Skills can use Read tool (if `allowed-tools: Read` specified)
4. **Path Resolution**: Relative paths like `./standards/...` resolve against repository/plugin root

**Note**: This verification applies to Strategy 1 only. Strategy 2 (dynamic repository access) remains unverified - see xref:#_1_skills_access_from_claudeai_web[Topic #1].

'''

=== 5. Private Repository Access üîç

==== Current Assumption

**Documented in**: `architecture-overview.adoc:152-155`

**Assumption**: Private repositories require "explicit configuration" but mechanism unspecified.

==== What Needs Testing

**For Private Repositories**:
* Can Claude.ai web access private GitHub repos if user is authenticated?
* Is there a `.claude/settings.json` field for repository credentials?
* Does it require repository to be cloned locally?
* Can agents reference private repo URLs directly?

==== Test Scenarios

**Scenario 1: Private Repository with GitHub Authentication**

1. Make test repository private on GitHub
2. Ensure test user has repository access (as collaborator or org member)
3. In Claude.ai web, reference skill from private repo:
   ```
   Read https://github.com/cuioss/cui-llm-rules/skills/test-skill/SKILL.md
   ```
4. Observe whether Claude can access the file

**Expected Results**:
* ‚úÖ Claude can access if user is authenticated to GitHub in browser
* ‚ùå Claude cannot access (requires alternative approach)

**Scenario 2: Local Clone Configuration**

1. Clone repository locally
2. Add to project `.claude/settings.json`:
   ```json
   {
     "repositories": {
       "cui-llm-rules": "/local/path/to/cui-llm-rules"
     }
   }
   ```
3. Agent references skill by repository name
4. Observe whether Claude resolves to local path

**Expected Results**:
* ‚úÖ Claude resolves repository name to local path
* ‚ùå No such configuration supported

**Scenario 3: Synchronization-Only Approach**

1. Keep repository private
2. Use `/synchronize --all --include-skills` to copy to `.claude/`
3. Commit `.claude/` to project (project can be private or public)
4. Test in Claude.ai web

**Expected Results**:
* ‚úÖ This should work (doesn't depend on repository access)
* Confirms Strategy 1 works with private repositories

==== Acceptance Criteria

* [ ] At least one approach works for private repositories
* [ ] Document authentication requirements (if any)
* [ ] Document configuration steps (if needed)
* [ ] Update architecture-overview.adoc with findings

==== Why This Matters

* Many organizations use private repositories for proprietary standards
* Affects adoption for enterprise users
* May influence whether Strategy 1 or Strategy 2 is preferred

==== Fallback Position

If no private repository access mechanism works:

* **Strategy 1 (Synchronization) is mandatory** for private repositories
* Skills/agents must be synchronized to `.claude/` (git-controlled)
* Document this as a known limitation
* Users must grant access to project repository, not plugin repository

'''

== OPTIMIZATION Research Topics

=== 6. ${CLAUDE_PLUGIN_ROOT} Environment Variable ‚úÖ VERIFIED

==== Current Assumption

**Documented in**: `plugin-structure.adoc:348-375`, `component-specifications.adoc:92`

**Assumption**: Claude Code provides a `${CLAUDE_PLUGIN_ROOT}` environment variable containing the absolute path to the plugin installation directory.

==== Verification Result

**Status**: ‚ùå **VARIABLE DOES NOT EXIST**

**Tested**: 2025-10-22

**Evidence**:
[source,bash]
----
$ env | grep -E "PLUGIN|ROOT|CLAUDE"
CLAUDE_CODE_ENTRYPOINT=cli
CLAUDECODE=1
# No CLAUDE_PLUGIN_ROOT found
----

**Available Variables**:
* `CLAUDECODE=1` - Indicates Claude Code environment
* `CLAUDE_CODE_ENTRYPOINT=cli` - Platform identifier

==== Solution Implemented

**Approach**: Use programmatic detection in scripts

[source,bash]
----
#!/bin/bash
# Detect plugin root from script location
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PLUGIN_ROOT="$(cd "${SCRIPT_DIR}/.." && pwd)"

# Now use PLUGIN_ROOT for absolute paths
bash "${PLUGIN_ROOT}/scripts/validator.sh"
----

**Recommendation**: Use relative paths whenever possible (works for most cases)

==== Documentation Updated

* ‚úÖ `plugin-structure.adoc:348-376` - Updated with verified information
* ‚úÖ `component-specifications.adoc:92` - Removed unverified warning

'''

=== 7. Skills Read Tool Restrictions üí°

==== Current Assumption

**Documented in**: `component-specifications.adoc:428-442`

**Assumption**: Skills should restrict tools to Read-only via `allowed-tools: Read`

==== What Needs Testing

**Questions**:
* What happens if skill has no `allowed-tools` restriction?
* Can skills execute arbitrary code if unrestricted?
* Is `allowed-tools` enforced or just advisory?

==== Why This Matters

Security and isolation of skills layer.

'''

=== 8. Essential Rules Drift Detection Automation üí°

==== Current Assumption

**Documented in**: `component-specifications.adoc:302-344`

**Assumption**: `/agents-doctor sync` requires manual approval for updates.

==== What Needs Testing

**Questions**:
* Could this be fully automated with user opt-in?
* Should there be a "safe mode" for non-breaking updates?
* Can we detect semantic vs. trivial changes?

==== Why This Matters

Reduces maintenance burden if automation is possible.

'''

== PLUGIN MANIFEST Research Topics

=== 9. plugin.json Field Support üîç

==== What Needs Testing

**Documented field support**:
[source,json]
----
{
  "claudeCode": {
    "minVersion": "0.1.0"  // Is this enforced?
  },
  "dependencies": {
    "plugins": [],         // Does this work?
    "mcpServers": []       // Does this work?
  }
}
----

**Questions**:
* Is `minVersion` enforced by Claude Code?
* Can plugins declare dependencies on other plugins?
* Can plugins require MCP servers?

==== Verification Steps

. Create test plugin with `minVersion` higher than Claude Code version
. Test if installation is blocked
. Test plugin dependency declaration
. Document actual behavior

'''

=== 10. Platform-Specific Components üí°

==== What Needs Testing

**Documented in**: `plugin-structure.adoc:244` (metadata.platforms)

**Assumption**: `platforms: ["cli", "jetbrains", "vscode"]` is metadata only, not functional filtering.

**Questions**:
* Can components be platform-specific?
* Does Claude Code hide components based on platform?
* Or is this just documentation?

==== Why This Matters

Could enable platform-optimized agents if supported.

'''

== Research Tracking

[cols="2,1,1,2"]
|===
|Topic |Priority |Status |Notes

|Skills Access from Claude.ai Web
|‚ö†Ô∏è CRITICAL
|‚è∏Ô∏è Deferred
|Lower priority per user guidance (Claude.ai web is new goal)

|Plugin Update Mechanism
|üîç IMPORTANT
|‚úÖ Verified
|2025-10-22: Confirmed via docs - marketplace update only

|Semantic Version Pinning
|üîç IMPORTANT
|‚ùå Not Tested
|Needs actual plugin installation test

|Skills Loading at Runtime (Strategy 1)
|üîç IMPORTANT
|‚úÖ Verified
|2025-10-22: Confirmed for synchronized skills. Strategy 2 unverified.

|Private Repository Access
|üîç IMPORTANT
|‚ùå Not Tested
|Dependent on Skills Access from web

|${CLAUDE_PLUGIN_ROOT} Environment Variable
|üîç IMPORTANT
|‚úÖ Verified
|2025-10-22: Variable does NOT exist

|Skills Read Tool Restrictions
|üí° OPTIMIZATION
|‚ùå Not Tested
|Low priority

|Essential Rules Automation
|üí° OPTIMIZATION
|‚ùå Not Tested
|Low priority

|plugin.json Field Support
|üîç IMPORTANT
|‚ùå Not Tested
|Needs actual plugin test

|Platform-Specific Components
|üí° OPTIMIZATION
|‚ùå Not Tested
|Low priority
|===

**Legend**:
* ‚úÖ Verified - Tested and documented
* ‚è∏Ô∏è Deferred - Postponed per prioritization
* ‚ùå Not Tested - Requires testing
* üîç IMPORTANT - Medium priority
* ‚ö†Ô∏è CRITICAL - High priority (when not deferred)
* üí° OPTIMIZATION - Low priority

'''

== Documentation Impact

Once research is completed, update the following documents:

=== If Skills Access WORKS as Assumed
* ‚úÖ No changes needed
* Add verification note to `architecture-overview.adoc`

=== If Skills Access FAILS
* üî¥ **CRITICAL**: Update `architecture-overview.adoc` (entire Skills Access Mechanism section)
* üî¥ **CRITICAL**: Update `synchronize-command-spec.adoc` (Skills Access Pattern section)
* üî¥ **CRITICAL**: Revise architecture to use Alternative Approach (see ¬ß1.4)
* Update README.adoc to reflect new approach

'''

== Test Repository Setup

For research verification, create:

[source,bash]
----
# Test repository structure
test-plugin-research/
‚îú‚îÄ‚îÄ .claude-plugin/
‚îÇ   ‚îî‚îÄ‚îÄ plugin.json
‚îú‚îÄ‚îÄ skills/
‚îÇ   ‚îî‚îÄ‚îÄ test-skill/
‚îÇ       ‚îî‚îÄ‚îÄ SKILL.md
‚îú‚îÄ‚îÄ standards/
‚îÇ   ‚îî‚îÄ‚îÄ test-standard.adoc
‚îî‚îÄ‚îÄ agents/
    ‚îî‚îÄ‚îÄ test-agent.md
----

**Purpose**: Minimal test case for each research topic.

**Repository**: Should be public for testing web access.

'''

== References

* Claude Code Plugin Docs: https://docs.claude.com/en/docs/claude-code/plugins
* WebFetch Tool Capabilities: https://docs.claude.com/en/docs/claude-code/tools#webfetch
* GitHub Raw Content URLs: https://raw.githubusercontent.com/

== Notes

* Research should be completed **before implementation begins**
* Critical topics (‚ö†Ô∏è) are **blockers** - architecture may need revision
* Important topics (üîç) affect implementation details but not feasibility
* Optimization topics (üí°) can be deferred to future iterations
